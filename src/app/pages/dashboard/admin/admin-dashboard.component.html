<div class="dashboard-container" data-theme="liquidGlace">
  <div class="liquid-gradient fixed inset-0 -z-10"></div>
  <div class="fixed inset-0 -z-10 bg-gradient-to-br from-slate-900/90 via-purple-900/80 to-slate-900/90"></div>

  <header class="sticky top-0 z-50 glass-effect-strong border-b border-white/20">
    <nav class="container mx-auto px-6 py-5 flex justify-between items-center">
      <div class="text-3xl font-bold text-gradient tracking-tight">
        Tamali - Administration
      </div>
      <button (click)="logout()" class="btn btn-sm btn-outline border-white/20 text-white rounded-full px-6">
        Déconnexion
      </button>
    </nav>
  </header>

  <main class="container mx-auto px-4 py-8">
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-white mb-2">Tableau de bord</h1>
      <p class="text-gray-300">Gestion des demandes d'utilisation du service</p>
    </div>

    @if (error) {
      <div class="mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-red-200 text-sm">
        {{ error }}
      </div>
    }

    <app-glass-card variant="strong" class="mb-8">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-white">Demandes de service</h2>
          <button 
            (click)="loadServiceRequests()" 
            [disabled]="loading"
            class="btn btn-sm btn-primary rounded-full px-4 disabled:opacity-50"
          >
            @if (loading) {
              <span>Chargement...</span>
            } @else {
              <span>Actualiser</span>
            }
          </button>
        </div>

        @if (loading && serviceRequests.length === 0) {
          <div class="text-center py-12">
            <p class="text-gray-400">Chargement des demandes...</p>
          </div>
        } @else if (serviceRequests.length === 0) {
          <div class="text-center py-12">
            <p class="text-gray-400">Aucune demande pour le moment.</p>
          </div>
        } @else {
          <div class="space-y-4">
            @for (request of serviceRequests; track request.id) {
              <div class="glass-effect-subtle p-5 rounded-lg border border-white/10">
                <div class="flex justify-between items-start mb-3">
                  <div class="flex-1">
                    <div class="flex items-center gap-3 mb-2">
                      <p class="font-semibold text-white">{{ request.email }}</p>
                      @if (request.processed) {
                        <span class="px-3 py-1 bg-green-500/20 text-green-300 text-xs rounded-full border border-green-500/50">
                          Traitée
                        </span>
                      } @else {
                        <span class="px-3 py-1 bg-yellow-500/20 text-yellow-300 text-xs rounded-full border border-yellow-500/50">
                          En attente
                        </span>
                      }
                    </div>
                    <p class="text-gray-300 text-sm mb-3 leading-relaxed">{{ request.objective }}</p>
                    <p class="text-gray-400 text-xs">Reçue le {{ formatDate(request.createdAt) }}</p>
                  </div>
                  @if (!request.processed) {
                    <button
                      (click)="markAsProcessed(request.id)"
                      class="btn btn-sm btn-primary rounded-full px-4 ml-4"
                    >
                      Marquer comme traitée
                    </button>
                  }
                </div>
              </div>
            }
          </div>
        }
      </div>
    </app-glass-card>
  </main>
</div>
